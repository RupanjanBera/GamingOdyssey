<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login - Gaming Odyssey</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --primary: #3B82F6;
      --secondary: #D946EF;
      --dark: #0F172A;
      --light: #F1F5F9;
      --mid: #1E293B;
    }
    body {
      font-family: 'Poppins', sans-serif;
      background-color: var(--dark);
      color: var(--light);
      -webkit-font-smoothing: antialiased;
      background-image: 
        radial-gradient(circle at 20% 30%, rgba(59, 130, 246, 0.1) 0%, transparent 25%),
        radial-gradient(circle at 80% 70%, rgba(217, 70, 239, 0.1) 0%, transparent 25%);
    }
    .tech-font {
      font-family: 'Orbitron', sans-serif;
    }
    .sidebar {
      background: linear-gradient(180deg, var(--mid) 0%, var(--dark) 100%);
      box-shadow: 4px 0 10px rgba(59, 130, 246, 0.15);
    }
    .hero-bg {
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.15), rgba(217, 70, 239, 0.15), var(--dark));
    }
    input, select {
      background: rgba(30, 41, 59, 0.7);
      color: var(--light);
      border: 1px solid rgba(59, 130, 246, 0.5);
      border-radius: 0.5rem;
      padding: 0.75rem;
      width: 100%;
      transition: all 0.3s ease;
      backdrop-filter: blur(5px);
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--secondary);
      box-shadow: 0 0 10px rgba(217, 70, 239, 0.3);
    }
    .submit-btn {
      background: linear-gradient(90deg, var(--primary), var(--secondary));
      color: white;
      font-weight: 600;
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      transition: all 0.3s ease;
      box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
    }
    .submit-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
    }
    .error {
      color: #F87171;
      font-size: 0.875rem;
      margin-top: 0.5rem;
    }
    .success {
      color: #4ADE80;
      font-size: 1rem;
      margin-top: 0.5rem;
    }
    .nav-link {
      position: relative;
      transition: all 0.3s ease;
    }
    .nav-link::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: -4px;
      left: 0;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      transition: width 0.3s ease;
    }
    .nav-link:hover::after {
      width: 100%;
    }
    .password-toggle {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      color: #94A3B8;
    }
    .gradient-border {
      position: relative;
      background: linear-gradient(145deg, var(--primary), var(--secondary));
      padding: 2px;
      border-radius: 0.75rem;
    }
    .gradient-border-inner {
      background: linear-gradient(145deg, var(--mid), var(--dark));
      border-radius: 0.625rem;
      padding: 2.5rem;
    }
    .divider {
      display: flex;
      align-items: center;
      text-align: center;
      color: #94A3B8;
      margin: 1.5rem 0;
    }
    .divider::before, .divider::after {
      content: '';
      flex: 1;
      border-bottom: 1px solid #475569;
    }
    .divider:not(:empty)::before {
      margin-right: .5em;
    }
    .divider:not(:empty)::after {
      margin-left: .5em;
    }

    /* Google Button Customization */
    #google-btn-container {
      /* This targets the container div for the Google button */
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0.5rem; /* Padding around the button */
      background: var(--mid); /* Background for the container */
      border-radius: 0.75rem; /* Rounded edges for the container */
      border: 1px solid var(--primary); /* Border for the container */
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transition: all 0.3s ease;
      overflow: hidden; /* Important to hide the default square edges */
    }
    #google-btn-container:hover {
      border-color: var(--secondary);
      box-shadow: 0 0 12px rgba(217, 70, 239, 0.4);
      transform: translateY(-2px);
    }
    /* Target the actual Google button's iframe for minimal adjustment */
    .g_id_signin {
      border-radius: 0.5rem !important; /* Force rounded edges on the button itself */
      width: 100% !important; /* Make it fill the container */
    }
    .g_id_signin > div { /* Target the inner div to ensure sizing is correct */
      width: 100% !important;
    }
  </style>
</head>
<body>
  <div class="fixed top-0 left-0 h-full w-64 sidebar z-20 hidden md:block">
    <div class="p-6">
      <div class="flex items-center space-x-3">
        <img src="https://cdn-icons-png.flaticon.com/512/3612/3612569.png" alt="Logo" class="w-10 h-10">
        <h1 class="text-2xl font-bold text-white leading-relaxed tech-font">Gaming Odyssey</h1>
      </div>
      <nav class="mt-12 space-y-4">
        <a href="index.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-home w-5 h-5"></i>
          <span>Home</span>
        </a>
        <a href="store.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-gamepad w-5 h-5"></i>
          <span>Store</span>
        </a>
        <a href="tournaments.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-trophy w-5 h-5"></i>
          <span>Tournaments</span>
        </a>
        <a href="trackorder.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-shipping-fast w-5 h-5"></i>
          <span>Track Order</span>
        </a>
        <a href="contactus.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-headset w-5 h-5"></i>
          <span>Contact Us</span>
        </a>
        <a href="aboutus.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-info-circle w-5 h-5"></i>
          <span>About Us</span>
        </a>
        <a href="login.html" class="flex items-center space-x-3 text-[var(--primary)] font-semibold nav-link">
           <i class="fas fa-sign-in-alt w-5 h-5"></i>
          <span>Login</span>
        </a>
        <a href="signup.html" class="flex items-center space-x-3 text-[#F1F5F9] font-semibold nav-link">
          <i class="fas fa-user-plus w-5 h-5"></i>
          <span>Sign Up</span>
        </a>
      </nav>
    </div>
  </div>

  <div class="md:ml-64">
    <section class="hero-bg min-h-[40vh] flex items-center justify-center text-center p-6">
      <div>
        <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold text-white mb-4 leading-tight tech-font">Welcome Back</h1>
        <p class="text-lg sm:text-xl text-[#F1F5F9] leading-relaxed">Log in to continue your gaming journey.</p>
      </div>
    </section>

    <section class="py-16 px-6">
      <div class="max-w-md mx-auto">
        <div class="gradient-border">
          <div class="gradient-border-inner">
            <form id="login-form" class="space-y-6">
              <h2 class="text-3xl font-bold text-white mb-6 text-center tech-font">Login</h2>
              
              <div>
                <label for="identifier" class="block text-[#F1F5F9] mb-2 font-semibold">Email or Username</label>
                <input type="text" id="identifier" name="identifier" required placeholder="Enter your email or username" />
              </div>
              
              <div>
                <label for="password" class="block text-[#F1F5F9] mb-2 font-semibold">Password</label>
                <div class="relative">
                  <input type="password" id="password" name="password" required placeholder="Enter your password" />
                  <i class="fas fa-eye-slash password-toggle" id="toggle-password"></i>
                </div>
              </div>
              
              <div class="flex items-center justify-between text-sm">
                  <label class="flex items-center space-x-2 text-[#F1F5F9]">
                      <input type="checkbox" id="remember-me" name="remember-me" class="w-4 h-4 rounded bg-[var(--mid)] border-[var(--primary)] focus:ring-[var(--secondary)]">
                      <span>Remember Me</span>
                  </label>
                  <a href="#" class="text-[var(--primary)] hover:underline">Forgot Password?</a>
              </div>
              
              <div class="text-center pt-2">
                <button type="submit" class="submit-btn w-full px-10 py-3 flex items-center justify-center gap-2 mx-auto">
                  <i class="fas fa-sign-in-alt"></i> Log In
                </button>
                <p id="form-status" class="mt-4 text-center error"></p>
              </div>

              <div class="divider">OR</div>

              <div id="google-btn-container" class="w-full max-w-sm mx-auto"></div>

              <div class="text-center pt-2 text-[#94A3B8]">
                Don't have an account? <a href="signup.html" class="text-[var(--primary)] hover:underline font-semibold">Sign Up</a>
              </div>
            </form>
          </div>
        </div>
      </div>
    </section>

     <footer class="bg-transparent py-12 px-6 border-t border-[#1E293B]">
        <div class="text-center">
          <p class="text-[#94A3B8] text-sm">© 2025 Gaming Odyssey. All rights reserved.</p>
        </div>
    </footer>
  </div>

  <script>
    // --- Google OAuth Implementation ---

    function jwt_decode(token) {
      try {
        return JSON.parse(atob(token.split('.')[1]));
      } catch (e) {
        return null;
      }
    }
    
    function handleCredentialResponse(response) {
      const responsePayload = jwt_decode(response.credential);
      const email = responsePayload.email;
      const firstName = responsePayload.given_name;

      const formStatus = document.getElementById('form-status');

      const users = JSON.parse(localStorage.getItem('users')) || [];

      const user = users.find(u => u.email === email);
      
      if (user) {
        formStatus.textContent = 'Login successful! Redirecting...';
        formStatus.className = 'success text-center';

        localStorage.setItem('userData', JSON.stringify({
          name: user.firstName || firstName,
          username: user.username,
          email: user.email,
        }));

        setTimeout(() => {
          window.location.href = 'index.html';
        }, 1500);

      } else {
        formStatus.textContent = 'Account not found. Please sign up first.';
        formStatus.className = 'error text-center';
      }
    }

    window.onload = function () {
      google.accounts.id.initialize({
        client_id: '964191300629-ri9d35rqf4p0tgshv4k8u31r5rptmf9m.apps.googleusercontent.com',
        callback: handleCredentialResponse
      });

      google.accounts.id.renderButton(
        document.getElementById('google-btn-container'), {
          theme: 'outline',
          size: 'large',
          type: 'standard',
          text: 'signin_with',
          shape: 'rectangular', /* This makes the default button rectangular */
          width: '100%', /* Occupy full width of its container */
          locale: 'en'
        }
      );
      
      google.accounts.id.prompt();
    };

    // --- Existing JavaScript ---

    // Toggle password visibility
    const togglePassword = document.getElementById('toggle-password');
    const passwordInput = document.getElementById('password');
    togglePassword.addEventListener('click', () => {
        const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
        passwordInput.setAttribute('type', type);
        togglePassword.classList.toggle('fa-eye');
        togglePassword.classList.toggle('fa-eye-slash');
    });

    // Form submission
    document.getElementById('login-form').addEventListener('submit', function(event) {
        event.preventDefault();
        
        const identifier = document.getElementById('identifier').value.trim();
        const password = document.getElementById('password').value;
        const statusEl = document.getElementById('form-status');
        
        const users = JSON.parse(localStorage.getItem('users')) || [];
        
        const user = users.find(u => (u.email === identifier || u.username === identifier));
        
        if (user && user.password === password) {
            statusEl.textContent = 'Login successful! Redirecting...';
            statusEl.className = 'success text-center';
            
            localStorage.setItem('userData', JSON.stringify({
                name: user.firstName,
                username: user.username,
                email: user.email,
            }));
            
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 1500);
        } else {
            statusEl.textContent = 'Invalid credentials. Please try again.';
            statusEl.className = 'error text-center';
        }
    });
  </script>
</body>
</html>
